{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
  <h1 class="h3 fw-bold mb-3">Dashboard</h1>

  <section class="bg-white rounded-4 shadow-sm p-4">

    <!-- Resumen superior -->
    <div class="row gx-3 mb-4">
      <div class="col-md-4 col-lg-3">
        <div class="bg-light rounded-3 shadow-sm p-3">
          <div class="small text-muted">Items con bajo stock</div>
          <div class="fs-3 fw-semibold mt-2">{{ items_bajo_minimo }}</div>
        </div>
      </div>
      <div class="col-md-4 col-lg-3">
        <div class="bg-light rounded-3 shadow-sm p-3">
          <div class="small text-muted">Órdenes de compra pendientes</div>
          <div class="fs-3 fw-semibold mt-2">{{ ordenes_pendientes }}</div>
        </div>
      </div>
    </div>

    <!-- Cabecera de la tabla -->
    <div class="rounded-3 bg-secondary bg-opacity-10 px-3 py-2 fw-semibold d-flex mb-2">
      <div class="flex-grow-1" style="width: 25%;">Código</div>
      <div class="flex-grow-1" style="width: 55%;">Nombre</div>
      <div class="text-end" style="width: 20%;">Stock</div>
    </div>

    <!-- Lista de insumos: críticos primero -->
    <div>
      {% for art in articulos %}
        <div class="d-flex align-items-center bg-white border rounded-3 px-3 py-2 mb-2
                    {% if art.stock_actual < art.stock_minimo %}border-danger{% endif %}">
          <div class="flex-grow-1 fw-semibold" style="width: 25%;">
            {{ art.codigo }}
          </div>
          <div class="flex-grow-1" style="width: 55%;">
            {{ art.descripcion }}
          </div>
          <div class="text-end" style="width: 20%;">
            {{ art.stock_actual }}
          </div>
        </div>
      {% empty %}
        <div class="text-center text-muted py-4">
          No hay artículos cargados.
        </div>
      {% endfor %}
    </div>

  </section>
{% endblock %}
